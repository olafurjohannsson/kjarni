(()=>{var A=class n{static __wrap(t){t=t>>>0;let e=Object.create(n.prototype);return e.__wbg_ptr=t,P.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,P.unregister(this),t}free(){let t=this.__destroy_into_raw();r.__wbg_wasmencoder_free(t,0)}encode_file(t,e){try{let i=r.__wbindgen_add_to_stack_pointer(-16),a=w(t,r.__wbindgen_export,r.__wbindgen_export2),g=u,p=w(e,r.__wbindgen_export,r.__wbindgen_export2),l=u;r.wasmencoder_encode_file(i,this.__wbg_ptr,a,g,p,l);var _=c().getInt32(i+4*0,!0),o=c().getInt32(i+4*1,!0),s=c().getInt32(i+4*2,!0);if(s)throw f(o);return f(_)}finally{r.__wbindgen_add_to_stack_pointer(16)}}static new(t){try{let s=r.__wbindgen_add_to_stack_pointer(-16),i=k(t,r.__wbindgen_export),a=u;r.wasmencoder_new(s,i,a);var e=c().getInt32(s+4*0,!0),_=c().getInt32(s+4*1,!0),o=c().getInt32(s+4*2,!0);if(o)throw f(_);return n.__wrap(e)}finally{r.__wbindgen_add_to_stack_pointer(16)}}};Symbol.dispose&&(A.prototype[Symbol.dispose]=A.prototype.free);var L=class n{static __wrap(t){t=t>>>0;let e=Object.create(n.prototype);return e.__wbg_ptr=t,H.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,H.unregister(this),t}free(){let t=this.__destroy_into_raw();r.__wbg_wasmindexbuilder_free(t,0)}add_chunk(t,e,_,o){try{let a=r.__wbindgen_add_to_stack_pointer(-16),g=w(t,r.__wbindgen_export,r.__wbindgen_export2),p=u,l=Z(e,r.__wbindgen_export),h=u,S=w(_,r.__wbindgen_export,r.__wbindgen_export2),F=u;r.wasmindexbuilder_add_chunk(a,this.__wbg_ptr,g,p,l,h,S,F,o);var s=c().getInt32(a+4*0,!0),i=c().getInt32(a+4*1,!0);if(i)throw f(s)}finally{r.__wbindgen_add_to_stack_pointer(16)}}add_file(t,e){try{let i=r.__wbindgen_add_to_stack_pointer(-16),a=w(t,r.__wbindgen_export,r.__wbindgen_export2),g=u,p=w(e,r.__wbindgen_export,r.__wbindgen_export2),l=u;r.wasmindexbuilder_add_file(i,this.__wbg_ptr,a,g,p,l);var _=c().getInt32(i+4*0,!0),o=c().getInt32(i+4*1,!0),s=c().getInt32(i+4*2,!0);if(s)throw f(o);return _>>>0}finally{r.__wbindgen_add_to_stack_pointer(16)}}doc_count(){return r.wasmindexbuilder_doc_count(this.__wbg_ptr)>>>0}finish(){try{let i=r.__wbindgen_add_to_stack_pointer(-16);r.wasmindexbuilder_finish(i,this.__wbg_ptr);var t=c().getInt32(i+4*0,!0),e=c().getInt32(i+4*1,!0),_=c().getInt32(i+4*2,!0),o=c().getInt32(i+4*3,!0);if(o)throw f(_);var s=$(t,e).slice();return r.__wbindgen_export4(t,e*1,1),s}finally{r.__wbindgen_add_to_stack_pointer(16)}}static new(t){try{let s=r.__wbindgen_add_to_stack_pointer(-16),i=k(t,r.__wbindgen_export),a=u;r.wasmindexbuilder_new(s,i,a);var e=c().getInt32(s+4*0,!0),_=c().getInt32(s+4*1,!0),o=c().getInt32(s+4*2,!0);if(o)throw f(_);return n.__wrap(e)}finally{r.__wbindgen_add_to_stack_pointer(16)}}};Symbol.dispose&&(L.prototype[Symbol.dispose]=L.prototype.free);var z=class n{static __wrap(t){t=t>>>0;let e=Object.create(n.prototype);return e.__wbg_ptr=t,D.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,D.unregister(this),t}free(){let t=this.__destroy_into_raw();r.__wbg_wasmmodel_free(t,0)}encode(t,e){try{let g=r.__wbindgen_add_to_stack_pointer(-16),p=tt(t,r.__wbindgen_export),l=u;r.wasmmodel_encode(g,this.__wbg_ptr,p,l,e);var _=c().getInt32(g+4*0,!0),o=c().getInt32(g+4*1,!0),s=c().getInt32(g+4*2,!0),i=c().getInt32(g+4*3,!0);if(i)throw f(s);var a=it(_,o).slice();return r.__wbindgen_export4(_,o*4,4),a}finally{r.__wbindgen_add_to_stack_pointer(16)}}static from_quantized(t){try{let s=r.__wbindgen_add_to_stack_pointer(-16),i=k(t,r.__wbindgen_export),a=u;r.wasmmodel_from_quantized(s,i,a);var e=c().getInt32(s+4*0,!0),_=c().getInt32(s+4*1,!0),o=c().getInt32(s+4*2,!0);if(o)throw f(_);return n.__wrap(e)}finally{r.__wbindgen_add_to_stack_pointer(16)}}static from_type(t){let e=r.wasmmodel_from_type(t);return f(e)}constructor(t,e,_){try{let a=r.__wbindgen_add_to_stack_pointer(-16),g=k(t,r.__wbindgen_export),p=u,l=w(e,r.__wbindgen_export,r.__wbindgen_export2),h=u,S=w(_,r.__wbindgen_export,r.__wbindgen_export2),F=u;r.wasmmodel_new(a,g,p,l,h,S,F);var o=c().getInt32(a+4*0,!0),s=c().getInt32(a+4*1,!0),i=c().getInt32(a+4*2,!0);if(i)throw f(s);return this.__wbg_ptr=o>>>0,D.register(this,this.__wbg_ptr,this),this}finally{r.__wbindgen_add_to_stack_pointer(16)}}};Symbol.dispose&&(z.prototype[Symbol.dispose]=z.prototype.free);var pt=Object.freeze({MiniLML6V2:0,0:"MiniLML6V2"}),U=class n{static __wrap(t){t=t>>>0;let e=Object.create(n.prototype);return e.__wbg_ptr=t,J.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,J.unregister(this),t}free(){let t=this.__destroy_into_raw();r.__wbg_wasmreranker_free(t,0)}static load(t){try{let s=r.__wbindgen_add_to_stack_pointer(-16),i=k(t,r.__wbindgen_export),a=u;r.wasmreranker_load(s,i,a);var e=c().getInt32(s+4*0,!0),_=c().getInt32(s+4*1,!0),o=c().getInt32(s+4*2,!0);if(o)throw f(_);return n.__wrap(e)}finally{r.__wbindgen_add_to_stack_pointer(16)}}rerank(t,e,_){try{let a=r.__wbindgen_add_to_stack_pointer(-16),g=w(t,r.__wbindgen_export,r.__wbindgen_export2),p=u,l=tt(e,r.__wbindgen_export),h=u;r.wasmreranker_rerank(a,this.__wbg_ptr,g,p,l,h,_);var o=c().getInt32(a+4*0,!0),s=c().getInt32(a+4*1,!0),i=c().getInt32(a+4*2,!0);if(i)throw f(s);return f(o)}finally{r.__wbindgen_add_to_stack_pointer(16)}}score(t,e){try{let i=r.__wbindgen_add_to_stack_pointer(-16),a=w(t,r.__wbindgen_export,r.__wbindgen_export2),g=u,p=w(e,r.__wbindgen_export,r.__wbindgen_export2),l=u;r.wasmreranker_score(i,this.__wbg_ptr,a,g,p,l);var _=c().getFloat32(i+4*0,!0),o=c().getInt32(i+4*1,!0),s=c().getInt32(i+4*2,!0);if(s)throw f(o);return _}finally{r.__wbindgen_add_to_stack_pointer(16)}}};Symbol.dispose&&(U.prototype[Symbol.dispose]=U.prototype.free);var B=class n{static __wrap(t){t=t>>>0;let e=Object.create(n.prototype);return e.__wbg_ptr=t,Q.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,Q.unregister(this),t}free(){let t=this.__destroy_into_raw();r.__wbg_wasmsearch_free(t,0)}add_chunk(t,e,_,o){try{let a=r.__wbindgen_add_to_stack_pointer(-16),g=w(t,r.__wbindgen_export,r.__wbindgen_export2),p=u,l=Z(e,r.__wbindgen_export),h=u,S=w(_,r.__wbindgen_export,r.__wbindgen_export2),F=u;r.wasmindexbuilder_add_chunk(a,this.__wbg_ptr,g,p,l,h,S,F,o);var s=c().getInt32(a+4*0,!0),i=c().getInt32(a+4*1,!0);if(i)throw f(s)}finally{r.__wbindgen_add_to_stack_pointer(16)}}doc_count(){return r.wasmindexbuilder_doc_count(this.__wbg_ptr)>>>0}static load(t,e){try{let i=r.__wbindgen_add_to_stack_pointer(-16),a=k(t,r.__wbindgen_export),g=u,p=k(e,r.__wbindgen_export),l=u;r.wasmsearch_load(i,a,g,p,l);var _=c().getInt32(i+4*0,!0),o=c().getInt32(i+4*1,!0),s=c().getInt32(i+4*2,!0);if(s)throw f(o);return n.__wrap(_)}finally{r.__wbindgen_add_to_stack_pointer(16)}}remove_file(t){let e=w(t,r.__wbindgen_export,r.__wbindgen_export2),_=u;return r.wasmsearch_remove_file(this.__wbg_ptr,e,_)>>>0}save_index(){try{let i=r.__wbindgen_add_to_stack_pointer(-16);r.wasmsearch_save_index(i,this.__wbg_ptr);var t=c().getInt32(i+4*0,!0),e=c().getInt32(i+4*1,!0),_=c().getInt32(i+4*2,!0),o=c().getInt32(i+4*3,!0);if(o)throw f(_);var s=$(t,e).slice();return r.__wbindgen_export4(t,e*1,1),s}finally{r.__wbindgen_add_to_stack_pointer(16)}}search(t,e){try{let i=r.__wbindgen_add_to_stack_pointer(-16),a=w(t,r.__wbindgen_export,r.__wbindgen_export2),g=u;r.wasmsearch_search(i,this.__wbg_ptr,a,g,e);var _=c().getInt32(i+4*0,!0),o=c().getInt32(i+4*1,!0),s=c().getInt32(i+4*2,!0);if(s)throw f(o);return f(_)}finally{r.__wbindgen_add_to_stack_pointer(16)}}search_keywords(t,e){try{let i=r.__wbindgen_add_to_stack_pointer(-16),a=w(t,r.__wbindgen_export,r.__wbindgen_export2),g=u;r.wasmsearch_search_keywords(i,this.__wbg_ptr,a,g,e);var _=c().getInt32(i+4*0,!0),o=c().getInt32(i+4*1,!0),s=c().getInt32(i+4*2,!0);if(s)throw f(o);return f(_)}finally{r.__wbindgen_add_to_stack_pointer(16)}}search_semantic(t,e){try{let i=r.__wbindgen_add_to_stack_pointer(-16),a=w(t,r.__wbindgen_export,r.__wbindgen_export2),g=u;r.wasmsearch_search_semantic(i,this.__wbg_ptr,a,g,e);var _=c().getInt32(i+4*0,!0),o=c().getInt32(i+4*1,!0),s=c().getInt32(i+4*2,!0);if(s)throw f(o);return f(_)}finally{r.__wbindgen_add_to_stack_pointer(16)}}update_file(t,e){try{let i=r.__wbindgen_add_to_stack_pointer(-16),a=w(t,r.__wbindgen_export,r.__wbindgen_export2),g=u,p=w(e,r.__wbindgen_export,r.__wbindgen_export2),l=u;r.wasmsearch_update_file(i,this.__wbg_ptr,a,g,p,l);var _=c().getInt32(i+4*0,!0),o=c().getInt32(i+4*1,!0),s=c().getInt32(i+4*2,!0);if(s)throw f(o);return _>>>0}finally{r.__wbindgen_add_to_stack_pointer(16)}}};Symbol.dispose&&(B.prototype[Symbol.dispose]=B.prototype.free);function Y(n){r.set_debug_logging(n)}function nt(){return{__proto__:null,"./kjarni_wasm_bg.js":{__proto__:null,__wbg_Error_8c4e43fe74559d73:function(t,e){let _=Error(m(t,e));return b(_)},__wbg_String_8f0eb39a4a4c2f66:function(t,e){let _=String(d(e)),o=w(_,r.__wbindgen_export,r.__wbindgen_export2),s=u;c().setInt32(t+4,s,!0),c().setInt32(t+0,o,!0)},__wbg___wbindgen_debug_string_0bc8482c6e3508ae:function(t,e){let _=C(d(e)),o=w(_,r.__wbindgen_export,r.__wbindgen_export2),s=u;c().setInt32(t+4,s,!0),c().setInt32(t+0,o,!0)},__wbg___wbindgen_is_function_0095a73b8b156f76:function(t){return typeof d(t)=="function"},__wbg___wbindgen_is_string_cd444516edc5b180:function(t){return typeof d(t)=="string"},__wbg___wbindgen_is_undefined_9e4d92534c42d778:function(t){return d(t)===void 0},__wbg___wbindgen_string_get_72fb696202c56729:function(t,e){let _=d(e),o=typeof _=="string"?_:void 0;var s=j(o)?0:w(o,r.__wbindgen_export,r.__wbindgen_export2),i=u;c().setInt32(t+4,i,!0),c().setInt32(t+0,s,!0)},__wbg___wbindgen_throw_be289d5034ed271b:function(t,e){throw new Error(m(t,e))},__wbg__wbg_cb_unref_d9b87ff7982e3b21:function(t){d(t)._wbg_cb_unref()},__wbg_arrayBuffer_bb54076166006c39:function(){return E(function(t){let e=d(t).arrayBuffer();return b(e)},arguments)},__wbg_call_389efe28435a9388:function(){return E(function(t,e){let _=d(t).call(d(e));return b(_)},arguments)},__wbg_call_4708e0c13bdc8e95:function(){return E(function(t,e,_){let o=d(t).call(d(e),d(_));return b(o)},arguments)},__wbg_error_7534b8e9a36f1ab4:function(t,e){let _,o;try{_=t,o=e,console.error(m(t,e))}finally{r.__wbindgen_export4(_,o,1)}},__wbg_fetch_4f06ca81d87798ba:function(t,e,_){let o=d(t).fetch(m(e,_));return b(o)},__wbg_fetch_d1488f40cef1e210:function(t,e,_){let o=d(t).fetch(m(e,_));return b(o)},__wbg_instanceof_Response_ee1d54d79ae41977:function(t){let e;try{e=d(t)instanceof Response}catch(o){e=!1}return e},__wbg_instanceof_Window_ed49b2db8df90359:function(t){let e;try{e=d(t)instanceof Window}catch(o){e=!1}return e},__wbg_instanceof_WorkerGlobalScope_07b9d5514ff0156e:function(t){let e;try{e=d(t)instanceof WorkerGlobalScope}catch(o){e=!1}return e},__wbg_length_32ed9a279acd054c:function(t){return d(t).length},__wbg_log_6b5ca2e6124b2808:function(t){console.log(d(t))},__wbg_new_361308b2356cecd0:function(){let t=new Object;return b(t)},__wbg_new_3eb36ae241fe6f44:function(){let t=new Array;return b(t)},__wbg_new_8a6f238a6ece86ea:function(){let t=new Error;return b(t)},__wbg_new_b5d9e2fb389fef91:function(t,e){try{var _={a:t,b:e},o=(i,a)=>{let g=_.a;_.a=0;try{return _t(g,_.b,i,a)}finally{_.a=g}};let s=new Promise(o);return b(s)}finally{_.a=_.b=0}},__wbg_new_dca287b076112a51:function(){return b(new Map)},__wbg_new_dd2b680c8bf6ae29:function(t){let e=new Uint8Array(d(t));return b(e)},__wbg_new_no_args_1c7c842f08d00ebb:function(t,e){let _=new Function(m(t,e));return b(_)},__wbg_now_a3af9a2f4bbaa4d1:function(){return Date.now()},__wbg_prototypesetcall_bdcdcc5842e4d77d:function(t,e,_){Uint8Array.prototype.set.call($(t,e),d(_))},__wbg_queueMicrotask_0aa0a927f78f5d98:function(t){let e=d(t).queueMicrotask;return b(e)},__wbg_queueMicrotask_5bb536982f78a56f:function(t){queueMicrotask(d(t))},__wbg_resolve_002c4b7d9d8f6b64:function(t){let e=Promise.resolve(d(t));return b(e)},__wbg_set_1eb0999cf5d27fc8:function(t,e,_){let o=d(t).set(d(e),d(_));return b(o)},__wbg_set_3f1d0b984ed272ed:function(t,e,_){d(t)[f(e)]=f(_)},__wbg_set_f43e577aea94465b:function(t,e,_){d(t)[e>>>0]=f(_)},__wbg_stack_0ed75d68575b0f3c:function(t,e){let _=d(e).stack,o=w(_,r.__wbindgen_export,r.__wbindgen_export2),s=u;c().setInt32(t+4,s,!0),c().setInt32(t+0,o,!0)},__wbg_static_accessor_GLOBAL_12837167ad935116:function(){let t=typeof global=="undefined"?null:global;return j(t)?0:b(t)},__wbg_static_accessor_GLOBAL_THIS_e628e89ab3b1c95f:function(){let t=typeof globalThis=="undefined"?null:globalThis;return j(t)?0:b(t)},__wbg_static_accessor_SELF_a621d3dfbb60d0ce:function(){let t=typeof self=="undefined"?null:self;return j(t)?0:b(t)},__wbg_static_accessor_WINDOW_f8727f0cf888e0bd:function(){let t=typeof window=="undefined"?null:window;return j(t)?0:b(t)},__wbg_text_083b8727c990c8c0:function(){return E(function(t){let e=d(t).text();return b(e)},arguments)},__wbg_then_0d9fe2c7b1857d32:function(t,e,_){let o=d(t).then(d(e),d(_));return b(o)},__wbg_then_b9e7b3b5f1a9e1b5:function(t,e){let _=d(t).then(d(e));return b(_)},__wbg_wasmmodel_new:function(t){let e=z.__wrap(t);return b(e)},__wbindgen_cast_0000000000000001:function(t,e){let _=st(t,e,r.__wasm_bindgen_func_elem_831,rt);return b(_)},__wbindgen_cast_0000000000000002:function(t){return b(t)},__wbindgen_cast_0000000000000003:function(t,e){let _=m(t,e);return b(_)},__wbindgen_cast_0000000000000004:function(t){let e=BigInt.asUintN(64,t);return b(e)},__wbindgen_object_clone_ref:function(t){let e=d(t);return b(e)},__wbindgen_object_drop_ref:function(t){f(t)}}}}function rt(n,t,e){r.__wasm_bindgen_func_elem_832(n,t,b(e))}function _t(n,t,e,_){r.__wasm_bindgen_func_elem_879(n,t,b(e),b(_))}var P=typeof FinalizationRegistry=="undefined"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_wasmencoder_free(n>>>0,1)),H=typeof FinalizationRegistry=="undefined"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_wasmindexbuilder_free(n>>>0,1)),D=typeof FinalizationRegistry=="undefined"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_wasmmodel_free(n>>>0,1)),J=typeof FinalizationRegistry=="undefined"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_wasmreranker_free(n>>>0,1)),Q=typeof FinalizationRegistry=="undefined"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_wasmsearch_free(n>>>0,1));function b(n){R===y.length&&y.push(y.length+1);let t=R;return R=y[t],y[t]=n,t}var X=typeof FinalizationRegistry=="undefined"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>n.dtor(n.a,n.b));function C(n){let t=typeof n;if(t=="number"||t=="boolean"||n==null)return`${n}`;if(t=="string")return`"${n}"`;if(t=="symbol"){let o=n.description;return o==null?"Symbol":`Symbol(${o})`}if(t=="function"){let o=n.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(n)){let o=n.length,s="[";o>0&&(s+=C(n[0]));for(let i=1;i<o;i++)s+=", "+C(n[i]);return s+="]",s}let e=/\[object ([^\]]+)\]/.exec(toString.call(n)),_;if(e&&e.length>1)_=e[1];else return toString.call(n);if(_=="Object")try{return"Object("+JSON.stringify(n)+")"}catch(o){return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:_}function ot(n){n<132||(y[n]=R,R=n)}function it(n,t){return n=n>>>0,K().subarray(n/4,n/4+t)}function $(n,t){return n=n>>>0,v().subarray(n/1,n/1+t)}var x=null;function c(){return(x===null||x.buffer.detached===!0||x.buffer.detached===void 0&&x.buffer!==r.memory.buffer)&&(x=new DataView(r.memory.buffer)),x}var M=null;function K(){return(M===null||M.byteLength===0)&&(M=new Float32Array(r.memory.buffer)),M}function m(n,t){return n=n>>>0,at(n,t)}var O=null;function v(){return(O===null||O.byteLength===0)&&(O=new Uint8Array(r.memory.buffer)),O}function d(n){return y[n]}function E(n,t){try{return n.apply(this,t)}catch(e){r.__wbindgen_export3(b(e))}}var y=new Array(128).fill(void 0);y.push(void 0,null,!0,!1);var R=y.length;function j(n){return n==null}function st(n,t,e,_){let o={a:n,b:t,cnt:1,dtor:e},s=(...i)=>{o.cnt++;let a=o.a;o.a=0;try{return _(a,o.b,...i)}finally{o.a=a,s._wbg_cb_unref()}};return s._wbg_cb_unref=()=>{--o.cnt===0&&(o.dtor(o.a,o.b),o.a=0,X.unregister(o))},X.register(s,o,o),s}function k(n,t){let e=t(n.length*1,1)>>>0;return v().set(n,e/1),u=n.length,e}function Z(n,t){let e=t(n.length*4,4)>>>0;return K().set(n,e/4),u=n.length,e}function tt(n,t){let e=t(n.length*4,4)>>>0,_=c();for(let o=0;o<n.length;o++)_.setUint32(e+4*o,b(n[o]),!0);return u=n.length,e}function w(n,t,e){if(e===void 0){let a=W.encode(n),g=t(a.length,1)>>>0;return v().subarray(g,g+a.length).set(a),u=a.length,g}let _=n.length,o=t(_,1)>>>0,s=v(),i=0;for(;i<_;i++){let a=n.charCodeAt(i);if(a>127)break;s[o+i]=a}if(i!==_){i!==0&&(n=n.slice(i)),o=e(o,_,_=i+n.length*3,1)>>>0;let a=v().subarray(o+i,o+_),g=W.encodeInto(n,a);i+=g.written,o=e(o,_,i,1)>>>0}return u=i,o}function f(n){let t=d(n);return ot(n),t}var T=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});T.decode();var ct=2146435072,q=0;function at(n,t){return q+=t,q>=ct&&(T=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),T.decode(),q=t),T.decode(v().subarray(n,n+t))}var W=new TextEncoder;"encodeInto"in W||(W.encodeInto=function(n,t){let e=W.encode(n);return t.set(e),{read:n.length,written:e.length}});var u=0,dt,r;function ut(n,t){return r=n.exports,dt=t,x=null,M=null,O=null,r.__wbindgen_start(),r}async function gt(n,t){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,t)}catch(o){if(n.ok&&e(n.type)&&n.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",o);else throw o}let _=await n.arrayBuffer();return await WebAssembly.instantiate(_,t)}else{let _=await WebAssembly.instantiate(n,t);return _ instanceof WebAssembly.Instance?{instance:_,module:n}:_}function e(_){switch(_){case"basic":case"cors":case"default":return!0}return!1}}async function et(n){if(r!==void 0)return r;n!==void 0&&(Object.getPrototypeOf(n)===Object.prototype?{module_or_path:n}=n:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),n===void 0&&(n=new URL("kjarni_wasm_bg.wasm",""));let t=nt();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));let{instance:e,module:_}=await gt(await n,t);return ut(e,_)}var N=null;function I(n,t){t?self.postMessage(n,t):self.postMessage(n)}var V=!1,G=[];self.onmessage=n=>{G.push(n),bt()};async function bt(){if(!V){for(V=!0;G.length>0;){let t=G.shift().data;try{switch(t.type){case"init":await ft(t);break;case"encode_batch":wt(t);break;case"set_logging":Y(t.enabled),I({type:"logging_set",id:t.id});break;default:I({type:"error",id:t.id,error:`Unknown: ${t.type}`})}}catch(e){I({type:"error",id:t.id,error:e.message||String(e)})}}V=!1}}async function ft(n){await et(n.wasmBytes),N=A.new(new Uint8Array(n.encoderBytes)),I({type:"init_done",id:n.id})}function wt(n){if(!N){I({type:"error",id:n.id,error:"Encoder not initialized"});return}let t=n.files,e=[],_=0;for(let o=0;o<t.length;o++){let s=t[o];try{let i=N.encode_file(s.text,s.path);for(let a of i)e.push({text:a.text,embedding:Array.from(a.embedding),source:a.source,chunk_index:a.chunk_index})}catch(i){_++}(o+1)%10===0&&I({type:"encode_progress",workerId:n.workerId,indexed:o+1,total:t.length,chunks:e.length})}I({type:"encode_done",id:n.id,workerId:n.workerId,chunks:e,fileCount:t.length,skipped:_})}})();
